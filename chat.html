<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Chat</title>

<style>
body{
background:#020617;
color:white;
font-family:Arial;
margin:0;
}

.top{
background:#0f172a;
padding:16px;
text-align:center;
font-size:18px;
font-weight:bold;
}

#chatBox{
height:70vh;
overflow-y:auto;
padding:15px;
}

.msg{
background:#111827;
padding:10px;
margin:8px;
border-radius:10px;
text-align:left;
}

.name{
color:#22c55e;
font-weight:bold;
}

.sendBox{
position:fixed;
bottom:0;
width:100%;
background:#0f172a;
padding:10px;
display:flex;
}

.sendBox input{
flex:1;
padding:12px;
border:none;
border-radius:10px;
margin-right:8px;
}

.sendBox button{
padding:12px 16px;
border:none;
border-radius:10px;
background:linear-gradient(45deg,#6366f1,#06b6d4);
color:white;
}
</style>
</head>

<body>

<div class="top">ðŸ’¬ Student Lounge</div>

<div id="chatBox"></div>

<div class="sendBox">
<input id="msg" placeholder="Type message">
<button onclick="send()">Send</button>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, query, orderBy } 
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig={
apiKey:"AIzaSyCEYfwfZv2Ckpg-uFLRvJkMBRlXA2w_WpI",
authDomain:"black-terminal-f2c91.firebaseapp.com",
projectId:"black-terminal-f2c91",
storageBucket:"black-terminal-f2c91.appspot.com",
messagingSenderId:"552489994197",
appId:"1:552489994197:web:7662331264c334ffbadf5c"
};

const app=initializeApp(firebaseConfig);
const db=getFirestore(app);

let student=localStorage.getItem("studentName")||"Student";

/* SEND */
window.send=async function(){
let text=document.getElementById("msg").value;
if(!text) return;

await addDoc(collection(db,"global_chat"),{
name:student,
msg:text,
time:Date.now()
});

document.getElementById("msg").value="";
}

/* LIVE LOAD */
const q=query(collection(db,"global_chat"),orderBy("time"));
onSnapshot(q,(snap)=>{
let html="";
snap.forEach(d=>{
let data=d.data();
html+=`
<div class="msg">
<span class="name">${data.name}</span><br>
${data.msg}
</div>`;
});

document.getElementById("chatBox").innerHTML=html;
document.getElementById("chatBox").scrollTop=999999;
});

</script>
</body>
</html>

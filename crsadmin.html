<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BT Admin | Pro Control</title>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #6366f1; --accent: #06b6d4; --danger: #ef4444; --bg: #020617; --success: #22c55e; }
        body { background: var(--bg); color: white; padding: 15px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .container { max-width: 500px; margin: 0 auto; }
        
        .admin-card { background: rgba(255,255,255,0.05); padding: 20px; border-radius: 25px; border: 1px solid rgba(255,255,255,0.1); margin-bottom: 20px; }
        h3 { color: var(--accent); margin-bottom: 15px; font-size: 18px; display: flex; align-items: center; gap: 8px; }
        
        label { font-size: 10px; font-weight: 800; color: #64748b; text-transform: uppercase; margin-left: 5px; }
        input, select { width: 100%; padding: 12px; margin: 5px 0 15px; background: #0f172a; border: 1px solid #334155; color: white; border-radius: 12px; outline: none; }
        
        .row { display: flex; gap: 10px; }
        .btn-add { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 15px; font-weight: 800; cursor: pointer; font-size: 14px; box-shadow: 0 10px 20px rgba(99, 102, 241, 0.2); }

        /* LIST STYLE */
        .course-card { 
            display: flex; justify-content: space-between; align-items: center; 
            background: #111827; padding: 15px; border-radius: 20px; 
            margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.05);
        }
        .info b { display: block; font-size: 15px; margin-bottom: 2px; }
        .info small { color: #94a3b8; font-size: 11px; display: block; }
        .price-tag { color: var(--success); font-weight: 800; }
        
        .btn-delete { 
            background: rgba(239, 68, 68, 0.1); color: #ef4444; 
            border: 1px solid rgba(239, 68, 68, 0.2); width: 42px; height: 42px; 
            border-radius: 12px; cursor: pointer; display: flex; 
            align-items: center; justify-content: center; font-size: 18px;
        }

        /* BADGE COLORS IN LIST */
        .badge-ui { font-size: 9px; padding: 2px 6px; border-radius: 4px; font-weight: 900; margin-left: 5px; text-transform: uppercase; }
        .tag-hot { background: #ef4444; }
        .tag-new { background: var(--accent); }
        .tag-trending { background: #a855f7; }
        .tag-free { background: var(--success); }
    </style>
</head>
<body>

<div class="container">
    <h2 style="text-align: center; margin: 10px 0 20px; font-weight: 800;">BT <span style="color:var(--primary)">PRO</span> PANEL</h2>

    <div class="admin-card">
        <h3><i class="ri-add-box-line"></i> Create Course</h3>
        
        <label>Course Name</label>
        <input type="text" id="name" placeholder="e.g. Full Stack Web Dev">

        <div class="row">
            <div style="flex:1">
                <label>Badge Type</label>
                <select id="tag">
                    <option value="none">No Badge</option>
                    <option value="HOT">HOT üî•</option>
                    <option value="NEW">NEW ‚ú®</option>
                    <option value="TRENDING">TRENDING üìà</option>
                    <option value="BESTSELLER">BESTSELLER üèÜ</option>
                    <option value="LIMITED">LIMITED ‚åõ</option>
                    <option value="FREE">FREE üéÅ</option>
                    <option value="POPULAR">POPULAR üåü</option>
                </select>
            </div>
            <div style="flex:1">
                <label>Category</label>
                <input type="text" id="cat" placeholder="e.g. Coding">
            </div>
        </div>

        <div class="row">
            <div style="flex:1">
                <label>Original Price (‚Çπ)</label>
                <input type="number" id="oldPrice" placeholder="e.g. 5000">
            </div>
            <div style="flex:1">
                <label>Offer Price (‚Çπ)</label>
                <input type="number" id="newPrice" placeholder="e.g. 999">
            </div>
        </div>

        <div class="row">
            <div style="flex:1">
                <label>Duration</label>
                <input type="text" id="dur" placeholder="e.g. 3 Months">
            </div>
            <div style="flex:1">
                <label>Icon Class</label>
                <select id="icon">
                    <option value="ri-mac-line">Computer</option>
                    <option value="ri-shield-keyhole-line">Hacking</option>
                    <option value="ri-code-s-slash-line">Coding</option>
                    <option value="ri-smartphone-line">Mobile</option>
                </select>
            </div>
        </div>

        <button class="btn-add" onclick="saveCourse()"><i class="ri-rocket-2-fill"></i> DEPLOY COURSE</button>
    </div>

    <div class="admin-card">
        <h3><i class="ri-pulse-line"></i> Live Courses ( <span id="count">0</span> )</h3>
        <div id="course-list">
             <p style="text-align: center; opacity: 0.3; font-size: 12px;">Connecting to database...</p>
        </div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCEYfwfZv2Ckpg-uFLRvJkMBRlXA2w_WpI",
        authDomain: "black-terminal-f2c91.firebaseapp.com",
        projectId: "black-terminal-f2c91",
        storageBucket: "black-terminal-f2c91.appspot.com",
        messagingSenderId: "552489994197",
        appId: "1:552489994197:web:7662331264c334ffbadf5c"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    window.saveCourse = async () => {
        const n = document.getElementById('name').value;
        const t = document.getElementById('tag').value;
        const op = document.getElementById('oldPrice').value;
        const np = document.getElementById('newPrice').value;
        const dr = document.getElementById('dur').value;
        const ct = document.getElementById('cat').value;
        const ic = document.getElementById('icon').value;

        if(!n || !np || !op) return alert("Fill Name, Original Price and Offer Price!");

        const discount = Math.round(((op - np) / op) * 100);

        try {
            await addDoc(collection(db, "courses"), {
                name: n, tag: t, oldPrice: op, newPrice: np, 
                offPercent: discount, duration: dr || 'Self-Paced',
                category: ct || 'General', icon: ic,
                onlineCount: Math.floor(Math.random() * 200) + 50,
                offlineCount: Math.floor(Math.random() * 50) + 10
            });
            alert("Success: Course deployed!");
            document.querySelectorAll('input').forEach(i => i.value = "");
        } catch(e) { alert("Error: " + e.message); }
    };

    onSnapshot(collection(db, "courses"), (snap) => {
        const listDiv = document.getElementById('course-list');
        document.getElementById('count').innerText = snap.size;
        listDiv.innerHTML = "";

        if (snap.empty) {
            listDiv.innerHTML = "<p style='text-align:center; opacity:0.5;'>No active courses.</p>";
            return;
        }

        snap.forEach((courseDoc) => {
            const data = courseDoc.data();
            const id = courseDoc.id;
            const tagClass = data.tag !== 'none' ? `tag-${data.tag.toLowerCase()}` : '';

            listDiv.innerHTML += `
                <div class="course-card">
                    <div class="info">
                        <b>${data.name} ${data.tag !== 'none' ? `<span class="badge-ui ${tagClass}">${data.tag}</span>` : ''}</b>
                        <small>${data.category} | ${data.duration}</small>
                        <small>Price: <span style="text-decoration:line-through; color:#ef4444">‚Çπ${data.oldPrice}</span> <span class="price-tag">‚Çπ${data.newPrice}</span> (${data.offPercent}% OFF)</small>
                    </div>
                    <button class="btn-delete" onclick="removeCourse('${id}')">
                        <i class="ri-delete-bin-line"></i>
                    </button>
                </div>
            `;
        });
    });

    window.removeCourse = async (id) => {
        if(confirm("Permanently delete this course?")) {
            await deleteDoc(doc(db, "courses", id));
        }
    };
</script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daily Jackpot Tournament</title>

<style>
body{
margin:0;
font-family:Arial;
background:linear-gradient(180deg,#020617,#020617,#031036);
color:white;
}

/* header */
.header{
padding:22px;
font-size:26px;
font-weight:bold;
}

.xpbox{
float:right;
background:#071428;
padding:8px 14px;
border-radius:12px;
color:#22c55e;
font-weight:bold;
}

/* main card */
.main{
padding:18px;
}

.card{
background:linear-gradient(145deg,#0f172a,#020617);
padding:26px;
border-radius:18px;
box-shadow:0 0 40px rgba(0,0,0,0.6);
margin-bottom:20px;
position:relative;
overflow:hidden;
}

/* animated border */
.card::before{
content:"";
position:absolute;
inset:-2px;
border-radius:20px;
background:linear-gradient(90deg,#06b6d4,#3b82f6,#8b5cf6,#06b6d4);
background-size:300%;
z-index:-1;
animation:borderMove 6s linear infinite;
}

@keyframes borderMove{
0%{background-position:0%}
100%{background-position:300%}
}

.title{
font-size:22px;
font-weight:bold;
margin-bottom:8px;
}

.sub{
color:#94a3b8;
margin-bottom:14px;
}

.pool{
font-size:20px;
color:#facc15;
margin-bottom:10px;
}

/* live pulse */
.live{
display:inline-block;
background:#052e1f;
color:#22c55e;
padding:8px 16px;
border-radius:30px;
font-weight:bold;
animation:pulse 1.5s infinite;
margin-top:10px;
}

@keyframes pulse{
0%{box-shadow:0 0 0 0 rgba(34,197,94,.6)}
70%{box-shadow:0 0 0 14px rgba(34,197,94,0)}
100%{box-shadow:0 0 0 0 rgba(34,197,94,0)}
}

/* button */
.btn{
margin-top:20px;
width:100%;
padding:16px;
border:none;
border-radius:14px;
font-size:17px;
font-weight:bold;
color:white;
background:linear-gradient(90deg,#4f46e5,#06b6d4);
box-shadow:0 10px 30px rgba(0,0,0,0.6);
}

.btn:active{
transform:scale(.95);
}

/* ranking */
.rankbox{
background:linear-gradient(145deg,#0f172a,#020617);
padding:20px;
border-radius:18px;
box-shadow:0 0 30px rgba(0,0,0,0.5);
}

.ranktitle{
font-size:20px;
margin-bottom:12px;
}

.rank{
padding:10px;
border-bottom:1px solid rgba(255,255,255,0.08);
}

</style>
</head>

<body>

<div class="header">
üèÜ Daily Jackpot Tournament
<span class="xpbox">üî• XP: <span id="myxp">0</span></span>
</div>

<div class="main">

<div class="card">
<div class="title">üí∞ Jackpot Pool: <span id="pool">0</span> XP</div>
<div class="sub">Entry fee: 50 XP ‚Ä¢ Time: 60s</div>

<div class="live">‚óè LIVE TOURNAMENT</div>

<button class="btn" onclick="enterTournament()">Enter Tournament</button>
</div>

<div class="rankbox">
<div class="ranktitle">üèÜ Live Ranking</div>
<div id="ranking"></div>
</div>

</div>

<!-- firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, doc, getDoc, updateDoc, onSnapshot, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyCEYfwfZv2Ckpg-uFLRvJkMBRlXA2w_WpI",
authDomain: "black-terminal-f2c91.firebaseapp.com",
projectId: "black-terminal-f2c91",
storageBucket: "black-terminal-f2c91.appspot.com",
messagingSenderId: "552489994197",
appId: "1:552489994197:web:7662331264c334ffbadf5c"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let student = localStorage.getItem("studentName");
let myxp=0;

/* load xp */
async function loadXP(){
let ref = doc(db,"students",student);
let snap = await getDoc(ref);
if(snap.exists()){
myxp = snap.data().xp || 0;
document.getElementById("myxp").innerText=myxp;
}
}
loadXP();

/* enter tournament */
window.enterTournament = async function(){

if(myxp<50){
alert("Need 50 XP to enter");
return;
}

/* minus xp */
let ref = doc(db,"students",student);
await updateDoc(ref,{xp:myxp-50});

alert("Entered Tournament üöÄ");

/* add score doc */
await addDoc(collection(db,"tournament"),{
name:student,
score:0
});

};

/* live ranking */
onSnapshot(collection(db,"tournament"),(snap)=>{
let arr=[];
snap.forEach(d=> arr.push(d.data()));

arr.sort((a,b)=>b.score-a.score);

let html="";
arr.forEach((p,i)=>{
html+=`<div class="rank">#${i+1} ${p.name} ‚Äî ${p.score}</div>`;
});

document.getElementById("ranking").innerHTML=html;
document.getElementById("pool").innerText=arr.length*50;

});

</script>

</body>
</html>